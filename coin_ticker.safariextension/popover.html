<link href=main.css rel=stylesheet><div id=wrap><div id=header><div id=openSettings></div>Coin Ticker<span>v1.0.0</span><div class=font-secondary id=status>init</div><div class=refresh><div class=timer><div class=mask></div></div><button id=refresh>Refresh</button></div></div><div id=main><div id=loaderContainer><div class=loader></div></div><div id=ticker><div id=welcome>Click the settings button to start tracking coins!</div><div class=item id=placeholder style=display:none><div class=title>Title<span></span></div><div class=data><div>Last price:&#160;<span class=last></span></div><div>24hr low:&#160;<span class=low></span></div><div>24hr high:&#160;<span class=high></span></div><div>24hr change:&#160;<span class=change></span></div></div></div></div><div id=settings><div class=title>Settings</div><p>Check all of the currency pairs you'd like to track. BTC prices are converted to USD by the GDAX current BTC/USD price. Regardless of the exchange we present the pairs as "coin/purchasing-currency."<div class=check-section><div class=title>GDAX</div><div class=checkboxes><div><input data-exchange=gdax id=BTC-USD onclick=saveSetting(event.target) type=checkbox value=BTC-USD><label for=BTC-USD>BTC/USD</label></div><div><input data-exchange=gdax id=ETH-BTC onclick=saveSetting(event.target) type=checkbox value=ETH-BTC><label for=ETH-BTC>ETH/BTC</label></div><div><input data-exchange=gdax id=ETH-USD onclick=saveSetting(event.target) type=checkbox value=ETH-USD><label for=ETH-USD>ETH/USD</label></div><div><input data-exchange=gdax id=LTC-BTC onclick=saveSetting(event.target) type=checkbox value=LTC-BTC><label for=LTC-BTC>LTC/BTC</label></div><div><input data-exchange=gdax id=LTC-USD onclick=saveSetting(event.target) type=checkbox value=LTC-USD><label for=LTC-USD>LTC/USD</label></div></div></div><div class=check-section><div class=title>Poloniex</div><div class=checkboxes><div><input data-exchange=poloniex id=BTC_BCH onclick=saveSetting(event.target) type=checkbox value=BTC_BCH><label for=BTC_BCH>BCH/BTC</label></div><div><input data-exchange=poloniex id=DASH onclick=saveSetting(event.target) type=checkbox value=DASH><label for=DASH>DASH/BTC</label></div><div><input data-exchange=poloniex id=BTC_DGB onclick=saveSetting(event.target) type=checkbox value=BTC_DGB><label for=BTC_DGB>DGB/BTC</label></div><div><input data-exchange=poloniex id=BTC_ETC onclick=saveSetting(event.target) type=checkbox value=BTC_ETC><label for=BTC_ETC>ETC/BTC</label></div><div><input data-exchange=poloniex id=BTC_ETH onclick=saveSetting(event.target) type=checkbox value=BTC_ETH><label for=BTC_ETH>ETH/BTC</label></div><div><input data-exchange=poloniex id=BTC_GAME onclick=saveSetting(event.target) type=checkbox value=BTC_GAME><label for=BTC_GAME>GAME/BTC</label></div><div><input data-exchange=poloniex id=BTC_LSK onclick=saveSetting(event.target) type=checkbox value=BTC_LSK><label for=BTC_LSK>LSK/BTC</label></div><div><input data-exchange=poloniex id=BTC_LTC onclick=saveSetting(event.target) type=checkbox value=BTC_LTC><label for=BTC_LTC>LTC/BTC</label></div><div><input data-exchange=poloniex id=BTC_OMG onclick=saveSetting(event.target) type=checkbox value=BTC_OMG><label for=BTC_OMG>OMG/BTC</label></div><div><input data-exchange=poloniex id=BTC_SC onclick=saveSetting(event.target) type=checkbox value=BTC_SC><label for=BTC_SC>SC/BTC</label></div><div><input data-exchange=poloniex id=BTC_STR onclick=saveSetting(event.target) type=checkbox value=BTC_STR><label for=BTC_STR>STR/BTC</label></div><div><input data-exchange=poloniex id=BTC_VTC onclick=saveSetting(event.target) type=checkbox value=BTC_VTC><label for=BTC_VTC>VTC/BTC</label></div><div><input data-exchange=poloniex id=BTC_XEM onclick=saveSetting(event.target) type=checkbox value=BTC_XEM><label for=BTC_XEM>XEM/BTC</label></div><div><input data-exchange=poloniex id=BTC_XMR onclick=saveSetting(event.target) type=checkbox value=BTC_XMR><label for=BTC_XMR>XMR/BTC</label></div><div><input data-exchange=poloniex id=BTC_XRP onclick=saveSetting(event.target) type=checkbox value=BTC_XRP><label for=BTC_XRP>XRP/BTC</label></div><div><input data-exchange=poloniex id=BTC_ZEC onclick=saveSetting(event.target) type=checkbox value=BTC_ZEC><label for=BTC_ZEC>ZEC/BTC</label></div></div></div><p>The currency pairs you check will appear in the ticker in the order they are represented on this page. Your settings will be saved in the local storage of your browser. If you clear your browser's local storage, you will clear your settings for this extension.</p><button id=closeSettings>Exit settings</button></div></div></div><script>function cl(e){}function updateStatus(e){document.getElementById("status").innerHTML=e}function getGdax(){var e=new XMLHttpRequest;e.timeout=2e4,updateStatus("Loading GDAX data..."),document.body.classList.add("loading"),e.onload=function(){var t=JSON.parse(e.responseText);for(var o in t)"BTC-USD"==o&&(btcPrice=Number(t[o].stats_24hour.last))},e.onloadend=function(){if(200===e.status){if(cl(btcPrice),gdaxCoins.length>0){var t=JSON.parse(e.responseText);for(var o in t)gdaxCoins.indexOf(o)>-1&&(document.querySelectorAll("."+o+".gdax").length<1?(buildElement(o,"gdax"),fillData(o,"gdax",t)):fillData(o,"gdax",t))}poloniexCoins.length>0?getPoloniex():(document.body.classList.remove("loading"),updateStatus("Last updated: "+getCurrentDateTime()))}else e.timeout>0&&0===e.status?(console.log("Timeout error getting data from "+tickers.gdax),updateStatus("Error, check console...")):(console.log("Error getting data from "+e.responseURL+" - "+e.responseText),updateStatus("Error, check console..."))},e.open("GET",tickers.gdax),e.send(null)}function getPoloniex(){var e=new XMLHttpRequest;e.timeout=2e4,updateStatus("Loading Poloniex data..."),e.onloadend=function(){if(200===e.status){var t=JSON.parse(e.responseText);console.log(t);for(var o in t)poloniexCoins.indexOf(o)>-1&&(document.querySelectorAll("."+o+".poloniex").length<1?(buildElement(o,"poloniex"),fillData(o,"poloniex",t)):fillData(o,"poloniex",t));document.body.classList.remove("loading"),updateStatus("Last updated: "+getCurrentDateTime())}else e.timeout>0&&0===e.status?(console.log("Timeout error getting data from "+tickers.poloniex),updateStatus("Error, check console...")):(console.log("Error getting data from "+e.responseURL+" - "+e.responseText),updateStatus("Error, check console..."))},e.open("GET",tickers.poloniex),e.send(null)}function buildElement(e,t){var o,n=document.getElementById("placeholder").cloneNode(!0),s=n.querySelector(".title");"gdax"===t?(o=e.split("-"),s.innerHTML=coinMap[o[0]]+" <span>GDAX ("+o[0]+"/"+o[1]+")</span>"):"poloniex"===t&&(o=e.split("_"),s.innerHTML=coinMap[o[1]]+" <span>Poloniex ("+o[1]+"/"+o[0]+")</span>"),n.removeAttribute("id"),n.removeAttribute("style"),n.classList.add(e),n.classList.add(t),n.classList.add("actual"),document.getElementById("ticker").appendChild(n)}function fillData(e,t,o){var n=document.querySelector("."+e+"."+t),s=n.querySelector(".last"),i=n.querySelector(".low"),a=n.querySelector(".high"),l=n.querySelector(".change");if("gdax"===t){var r=e.split("-");"USD"===r[1]?(s.innerHTML="$"+makeNum(o[e].stats_24hour.last),i.innerHTML="$"+makeNum(o[e].stats_24hour.low),a.innerHTML="$"+makeNum(o[e].stats_24hour.high)):"BTC"===r[1]&&(s.innerHTML="$"+makeNum(o[e].stats_24hour.last*btcPrice),i.innerHTML="$"+makeNum(o[e].stats_24hour.low*btcPrice),a.innerHTML="$"+makeNum(o[e].stats_24hour.high*btcPrice)),l.innerHTML=percChange(o[e].stats_24hour.open,o[e].stats_24hour.last)+"%",parseFloat(percChange(o[e].stats_24hour.open,o[e].stats_24hour.last))<0?l.style.color="red":l.style.color="green"}else"poloniex"===t&&(s.innerHTML="$"+makeNum(o[e].last*btcPrice),i.innerHTML="$"+makeNum(o[e].low24hr*btcPrice),a.innerHTML="$"+makeNum(o[e].high24hr*btcPrice),l.innerHTML=parseFloat(100*o[e].percentChange).toFixed(2)+"%",parseFloat(parseFloat(100*o[e].percentChange).toFixed(2))<0?l.style.color="red":l.style.color="green")}function makeNum(e){return e>1?parseFloat(e).toFixed(2):e>.1?parseFloat(e).toFixed(3):e>.01?parseFloat(e).toFixed(4):parseFloat(e).toFixed(5)}function percChange(e,t){var o=100*((e-t)/e);return parseFloat(-1*o).toFixed(2)}function getCurrentDateTime(){var e=new Date,t=e.toString().split(" ",4).join(" "),o=e.toString().split(" ")[4],n=o.slice(0,-6);return n>=13&&(n-=12),"00"==n&&(n="12"),t+" "+(n=("0"+n).slice(-2))+o.slice(-6)}function refresh(){localStorage.length>0&&(getGdax(),disableButtons())}function start(){updateStatus("Starting..."),ls.length>0?(welcomeMessage.style.display="none",getGdax()):updateStatus("Ready...")}function disableButtons(){refreshButton.disabled=!0,openSettings.classList.add("disabled"),document.body.classList.add("timer-on"),setTimeout(function(){refreshButton.disabled=!1,openSettings.classList.remove("disabled"),document.body.classList.remove("timer-on")},3e3)}function saveSetting(e){var t,o=e.dataset.exchange,n=e.value;if(e.checked)switch(String(o)){case"gdax":gdaxCoins.push(n),ls.setItem(o,gdaxCoins);break;case"poloniex":poloniexCoins.push(n),ls.setItem(o,poloniexCoins)}else switch(String(o)){case"gdax":t=gdaxCoins.indexOf(n),gdaxCoins.splice(t,1),ls.setItem(o,gdaxCoins),gdaxCoins.length<1&&ls.removeItem(o);break;case"poloniex":t=poloniexCoins.indexOf(n),poloniexCoins.splice(t,1),ls.setItem(o,poloniexCoins),poloniexCoins.length<1&&ls.removeItem(o)}}function loadSettings(){if(ls.length>0){cl("local storage exists, we should load it");var e;if(Object.keys(ls).indexOf("gdax")>-1){e=ls.gdax.split(","),gdaxCoins=e;for(var t=0;t<e.length;t++)document.getElementById(e[t]).setAttribute("checked",!0)}if(Object.keys(ls).indexOf("poloniex")>-1){e=ls.poloniex.split(","),poloniexCoins=e;for(var o=0;o<e.length;o++)document.getElementById(e[o]).setAttribute("checked",!0)}}}function showSettingsPage(){cl("opening settings page"),settingsVisible=!0,document.body.classList.add("show-settings")}function closeSettingsPage(){cl("closing settings page"),document.body.classList.remove("show-settings"),document.querySelectorAll(".actual").forEach(function(e){return e.parentNode.removeChild(e)}),settingsVisible=!1,ls.length>0?(getGdax(),welcomeMessage.style.display="none"):welcomeMessage.removeAttribute("style")}var btcPrice,settingsVisible=!1,gdaxCoins=[],poloniexCoins=[],ls=localStorage,refreshButton=document.getElementById("refresh"),openSettings=document.getElementById("openSettings"),closeSettings=document.getElementById("closeSettings"),welcomeMessage=document.getElementById("welcome"),tickers={gdax:"https://api.gdax.com/products/stats",poloniex:"https://poloniex.com/public?command=returnTicker"},coinMap={BCH:"Bitcoin Cash",BTC:"Bitcoin",DGB:"DigiByte",ETC:"Ethereum Classic",ETH:"Ethereum",GAME:"Gamecredits",LSK:"Lisk",LTC:"Litecoin",OMG:"OmiseGO",SC:"Siacoin",STR:"Stellar",VTC:"Vertcoin",XEM:"Nem",XMR:"Monero",XRP:"Ripple",ZEC:"Zcash"};refreshButton.addEventListener("click",refresh),openSettings.addEventListener("click",showSettingsPage),closeSettings.addEventListener("click",closeSettingsPage),loadSettings()</script>